<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>EnergiZen</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link 
    rel="stylesheet"
    href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css"
  >
  <style>
    header {
      background: #88b42a;
      color: #fcfcf2;
      padding: 20px;
      text-align: center;
      position: relative;
    }
    #carritoIcono {
      position: absolute;
      top: 40px;
      right: 30px;
      cursor: pointer;
    }
    #carritoIcono span {
      background: red;
      border-radius: 50%;
      padding: 2px 6px;
      font-size: 12px;
      color: #fff;
      position: absolute;
      top: -10px;
      right: -10px;
    }
  </style>
</head>
<body>

<header>
  <h1>EnergiZen</h1>
  <p>La fuerza que te impulsa, el equilibrio que te guía</p>
  <div id="carritoIcono" onclick="mostrarCarrito()">
    🛒 <span id="carritoCantidad">0</span>
  </div>
</header>

<div class="container my-3">
  <nav class="mb-3 text-center">
    <button class="btn btn-outline-success mx-1" onclick="filtrarProductos('somos')">¿Quienes Somos?</button>
    <button class="btn btn-outline-success mx-1" onclick="filtrarProductos('proteinas')">Proteínas</button>
    <button class="btn btn-outline-success mx-1" onclick="filtrarProductos('suplementos')">Suplementos</button>
    <button class="btn btn-outline-success mx-1" onclick="filtrarProductos('ansioliticos')">Ansiolíticos</button>
  </nav>

  <div class="row" id="items"></div>

  <!-- Sección Quiénes Somos -->
  <div id="somos" style="display: none;">
    <center><h1>¿Quiénes Somos?...</h1></center>
    <h2>EnergiZen es una empresa dedicada a la comercialización y desarrollo de suplementos alimenticios orgánicos, con un enfoque integral en la salud y el bienestar. Ofrecemos productos de alta calidad que mejoran el rendimiento físico, mental y el bienestar general, apoyando marcas mexicanas del sector.</h2>
    <center><img src="EnergiZen.png"/></center>
  </div>

  <!-- Carrito -->
  <div id="carrito" style="display: none;">
    <center><h2>Carrito de Compras</h2></center>
    <ul id="listaCarrito" class="list-group mb-3"></ul>
    <p><strong>Total:</strong> $<span id="total">0</span></p>
    <button id="comprarBtn" class="btn btn-success" onclick="mostrarLogin()">Comprar</button>
    <button class="btn btn-secondary mt-3" onclick="filtrarProductos('todos')">Volver al Catálogo</button>
  </div>
  
  <!-- Login -->
  <div id="loginForm" style="display: none;">
    <center><h2>Iniciar sesión para completar la compra</h2></center>
    <input type="text" id="username" placeholder="Usuario" class="form-control mb-2">
    <input type="password" id="password" placeholder="Contraseña" class="form-control mb-2">
    <button class="btn btn-primary" onclick="realizarCompra()">Confirmar Compra</button>
    <p id="loginMsg" style="color: red;"></p>
    <p>¿No tienes cuenta? <a href="#" onclick="mostrarRegistro()">Regístrate aquí</a></p>
    <button class="btn btn-secondary mt-3" onclick="filtrarProductos('todos')">Volver al Catálogo</button>
  </div>

  <!-- Registro -->
  <div id="registerForm" style="display: none;">
    <center><h2>Crear una cuenta</h2></center>
    <input type="text" id="newUsername" placeholder="Nuevo Usuario" class="form-control mb-2">
    <input type="password" id="newPassword" placeholder="Nueva Contraseña" class="form-control mb-2">
    <button class="btn btn-success" onclick="registrarUsuario()">Registrar</button>
    <p id="registerMsg" style="color: red;"></p>
    <button class="btn btn-secondary mt-3" onclick="mostrarLogin()">Volver al Login</button>
  </div>
</div>

<script>
   const productos = [
  { id: 1, nombre: 'Proteína Zen', precio: 380.00, categoria: 'proteinas', imagen: "ProteinaZen.png", referencia: { tienda: "Amazon", precio: 400.00 } },
  { id: 2, nombre: 'Vitaminas B-Plus', precio: 100.00, categoria: 'suplementos', imagen: "VitaminaB.png", referencia: { tienda: "Farmacias Similares", precio: 120.00 } },
  { id: 3, nombre: 'Omega 3 Pure', precio: 90.00, categoria: 'suplementos', imagen: "Omega3.png", referencia: { tienda: "MercadoLibre", precio: 95.00 } },
  { id: 4, nombre: 'CalmaZen', precio: 150.00, categoria: 'ansioliticos', imagen: "CalmaZen.png", referencia: { tienda: "Farmacias Similares", precio: 170.00 } },
  { id: 5, nombre: 'Proteína Herbal', precio: 456.00, categoria: 'proteinas', imagen: "ProteinaHerbal.png", referencia: { tienda: "Amazon", precio: 470.00 } },
  { id: 6, nombre: 'Tranquilizante Natural', precio: 78.00, categoria: 'ansioliticos', imagen: "Tranquilizante.png", referencia: { tienda: "Farmacias Similares", precio: 90.00 } },
  { id: 7, nombre: 'Proteina vegana de chicharo', precio: 305.00, categoria: 'proteinas', imagen: "prochicharo.png", referencia: { tienda: "MercadoLibre", precio: 320.00 } },
  { id: 8, nombre: 'Omegas veganos', precio: 366.00, categoria: 'suplementos', imagen: "omegas.png", referencia: { tienda: "Amazon", precio: 390.00 } },
  { id: 9, nombre: 'Proteína Birdman Fitmingo', precio: 508.00, categoria: 'proteinas', imagen: "birdman.png", referencia: { tienda: "Amazon", precio: 520.00 } },
  { id: 10, nombre: 'Fenogreco ', precio: 259.00, categoria: 'suplementos', imagen: "feno.png", referencia: { tienda: "Farmacias Similares", precio: 265.00 } },
  { id: 11, nombre: 'CHILL', precio: 549.00, categoria: 'ansioliticos', imagen: "chill.png", referencia: { tienda: "Amazon", precio: 560.00 } },
  { id: 12, nombre: 'Proteina de Soya', precio: 299.00, categoria: 'proteinas', imagen: "prosoy.png", referencia: { tienda: "MercadoLibre", precio: 310.00 } },
  { id: 13, nombre: 'Agariana', precio: 275.00, categoria: 'ansioliticos', imagen: "agariana.png", referencia: { tienda: "Farmacias Similares", precio: 285.00 } },
  { id: 14, nombre: 'OBY NAD +', precio: 419.00, categoria: 'suplementos', imagen: "oby.png", referencia: { tienda: "Amazon", precio: 430.00 } },
  { id: 15, nombre: 'CALM DOWN Platinum', precio: 599.00, categoria: 'ansioliticos', imagen: "calm.png", referencia: { tienda: "MercadoLibre", precio: 620.00 } }
];


  let carrito = [];
  let usuarios = { cliente: '1234' };

  const ocultarTodo = () => {
    document.getElementById('items').style.display = 'none';
    document.getElementById('somos').style.display = 'none';
    document.getElementById('carrito').style.display = 'none';
    document.getElementById('loginForm').style.display = 'none';
    document.getElementById('registerForm').style.display = 'none';
  };

  const renderProductos = (filtro) => {
  ocultarTodo();
  const contenedor = document.getElementById('items');
  contenedor.style.display = 'flex';
  contenedor.innerHTML = '';
  document.getElementById('somos').style.display = filtro === 'somos' ? 'block' : 'none';
  if (filtro === 'somos') return;
  const filtrados = filtro === 'todos' ? productos : productos.filter(p => p.categoria === filtro);
  filtrados.forEach(p => {
    const card = document.createElement('div');
    card.className = 'card col-sm-4';
    card.innerHTML = `
      <div class="card-body text-center">
        <img src="${p.imagen}" class="img-fluid mb-2" alt="${p.nombre}">
        <h5 class="card-title">${p.nombre}</h5>
        <p class="card-text">
          <strong>Precio EnergiZen:</strong> $${p.precio}<br>
          
        </p>
        <button class="btn btn-primary" onclick="agregarAlCarrito(${p.id})">Agregar</button>
        <button class="btn btn-secondary ml-2" onclick="toggleComparacionPrecios(${p.id})">Comparar Precios</button>
        <div id="comparacion-${p.id}" class="comparacion-precios" style="display:none; margin-top: 10px;">
          <p><strong>Comparación de Precios:</strong></p>
          <p><strong>Precio EnergiZen:</strong> $${p.precio}</p>
          <p><strong>${p.referencia.tienda}:</strong> $${p.referencia.precio}</p>
          <p><strong>Diferencia:</strong> $${(p.referencia.precio - p.precio).toFixed(2)}</p>
        </div>
      </div>`;
    contenedor.appendChild(card);
  });
  };

  // Función para mostrar/ocultar la comparación de precios
const toggleComparacionPrecios = (id) => {
  const comparacion = document.getElementById(`comparacion-${id}`);
  if (comparacion.style.display === 'none') {
    comparacion.style.display = 'block';
  } else {
    comparacion.style.display = 'none';
  }
};

  const agregarAlCarrito = (id) => {
    carrito.push(id);
    actualizarCarrito();
  };

  const actualizarCarrito = () => {
    const lista = document.getElementById('listaCarrito');
    lista.innerHTML = '';
    const sinDuplicados = [...new Set(carrito)];
    let total = 0;
    sinDuplicados.forEach(id => {
      const item = productos.find(p => p.id === id);
      const cantidad = carrito.filter(p => p === id).length;
      total += item.precio * cantidad;
      const li = document.createElement('li');
      li.className = 'list-group-item d-flex justify-content-between align-items-center';
      li.innerHTML = `${cantidad} x ${item.nombre} - $${item.precio}
        <button class="btn btn-sm btn-danger" onclick="eliminarDelCarrito(${id})">X</button>`;
      lista.appendChild(li);
    });
    document.getElementById('total').innerText = total.toFixed(2);
    document.getElementById('carritoCantidad').innerText = carrito.length;
  };

  const eliminarDelCarrito = (id) => {
    carrito = carrito.filter(p => p !== id);
    actualizarCarrito();
  };

  const mostrarCarrito = () => {
    ocultarTodo();
    document.getElementById('carrito').style.display = 'block';
  };

  const mostrarLogin = () => {
    ocultarTodo();
    document.getElementById('loginForm').style.display = 'block';
  };

  const mostrarRegistro = () => {
    ocultarTodo();
    document.getElementById('registerForm').style.display = 'block';
  };

  const realizarCompra = () => {
    const user = document.getElementById('username').value;
    const pass = document.getElementById('password').value;
    const msg = document.getElementById('loginMsg');

    if (usuarios[user] && usuarios[user] === pass) {
      const resumenHTML = generarResumenHTML();
      const total = calcularTotal().toFixed(2);

      const nuevaVentana = window.open('', '_blank', 'width=600,height=600');
      nuevaVentana.document.write(`
        <html>
          <head>
            <title>Resumen de Compra</title>
            <style>
              body { font-family: Arial; padding: 20px; }
              h2 { color: #88b42a; }
              ul { list-style: none; padding: 0; }
              li { padding: 5px 0; }
              button { margin-top: 20px; padding: 10px 15px; background: #88b42a; border: none; color: white; cursor: pointer; }
            </style>
          </head>
          <body>
            <h2>Gracias por tu compra, ${user}</h2>
            <p>Resumen del pedido:</p>
            ${resumenHTML}
            <p><strong>Total:</strong> $${total}</p>
            <button onclick="window.print()">Imprimir</button>
          </body>
        </html>
      `);
      nuevaVentana.document.close();

      vaciarCarrito();
      ocultarTodo();
    } else {
      msg.innerText = 'Usuario o contraseña incorrectos.';
    }
  };

  const registrarUsuario = () => {
    const user = document.getElementById('newUsername').value.trim();
    const pass = document.getElementById('newPassword').value.trim();
    const msg = document.getElementById('registerMsg');

    if (!user || !pass) {
      msg.innerText = 'Por favor llena todos los campos.';
      return;
    }

    if (usuarios[user]) {
      msg.innerText = 'El usuario ya existe.';
      return;
    }

    usuarios[user] = pass;
    msg.style.color = 'green';
    msg.innerText = 'Usuario registrado exitosamente. Ahora puedes iniciar sesión.';
    setTimeout(() => {
      mostrarLogin();
      document.getElementById('registerMsg').innerText = '';
      document.getElementById('newUsername').value = '';
      document.getElementById('newPassword').value = '';
    }, 2000);
  };

  const calcularTotal = () => {
    return carrito.reduce((sum, id) => {
      const item = productos.find(p => p.id === id);
      return sum + item.precio;
    }, 0);
  };

  const generarResumenHTML = () => {
    const sinDuplicados = [...new Set(carrito)];
    let html = '<ul>';
    sinDuplicados.forEach(id => {
      const item = productos.find(p => p.id === id);
      const cantidad = carrito.filter(p => p === id).length;
      html += `<li>${cantidad} x ${item.nombre} - $${item.precio} c/u</li>`;
    });
    html += '</ul>';
    return html;
  };

  const vaciarCarrito = () => {
    carrito = [];
    actualizarCarrito();
  };

  const filtrarProductos = (categoria) => {
    renderProductos(categoria);
  };

  window.onload = () => renderProductos('todos');

  function mostrarComparador() {
  const sinDuplicados = [...new Set(productosSeleccionados)];

  const filas = sinDuplicados.map(id => {
    const p = productos.find(prod => prod.id === id);
    return `
      <tr>
        <td><img src="${p.imagen}" alt="${p.nombre}" style="width:80px;"></td>
        <td>${p.nombre}</td>
        <td>
          <strong>EnergiZen:</strong> $${p.precio.toFixed(2)}<br>
          <strong>${p.referencia.tienda}:</strong> $${p.referencia.precio.toFixed(2)}
        </td>
      </tr>`;
  }).join('');

  document.getElementById('comparador-body').innerHTML = filas;
  document.getElementById('comparadorModal').style.display = 'block';
}
</script>

</body>
</html>
